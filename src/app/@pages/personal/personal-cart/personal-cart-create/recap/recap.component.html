<p-messages
  [(value)]="messages!"
  [enableService]="false"
  [closable]="false"
></p-messages>
<div class="flex flex-column w-full tman-shadow px-5 py-3 border-round mb-4">
  <ng-container *ngIf="!!this.cartForm">
    <div
      class="flex flex-column w-full px-5 py-3 border-round mb-4"
      [formGroup]="cartForm"
    >
      <div class="flex justify-content-between">
        <div class="flex flex-column">
          <h2>Trasferta a {{ city.name }}</h2>
          <p>del {{ eventDate | customDate }}</p>
        </div>
        <div class="flex flex-column align-items-end">
          <h3>Squadra</h3>
          <p>{{ awayTeam.name }}</p>
        </div>
      </div>
      <div class="flex flex-column mt-5">
        <p class="font-semibold mb-2">Partecipanti</p>
        <p>Calciatori: {{ this.cartForm.get("players")?.value }}</p>
        <p>Staff: {{ this.cartForm.get("staffs")?.value }}</p>
        <p>Dirigenti: {{ this.cartForm.get("managers")?.value }}</p>
        <p class="my-1 text-lg">Totale: {{ totalPax }}</p>
      </div>
      <p-divider></p-divider>
      <div class="flex flex-column mt-1">
        <p class="font-semibold mb-2">Alloggio</p>
        <p>
          {{ hotel }} - dal
          {{ this.cartForm.get("startDate")?.value | customDate }} al
          {{ this.cartForm.get("endDate")?.value | customDate }}
        </p>
      </div>
      <p-divider></p-divider>
      <div class="flex flex-column mt-1">
        <p class="font-semibold mb-2">Camere</p>
        <p-table [value]="rooms">
          <ng-template pTemplate="header">
            <tr>
              <th>Tipologia</th>
              <th>Quantità</th>
              <th class="text-right">Prezzo</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-room>
            <tr>
              <td>{{ room.name }}</td>
              <td>{{ room.quantity }}</td>
              <td class="text-right">
                {{ room.price | currency : "EUR" : "symbol" }}
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
      <p-divider></p-divider>
      <div class="flex flex-column mt-1">
        <p class="font-semibold mb-2">Autonoleggio</p>
        <ng-container *ngFor="let r of roads">
          <div class="mb-2">
            <p class="mb-1">Da {{ r.from }} a {{ r.to }}</p>
            <p class="mb-1">
              {{ r.startDate | customDate : "showHours" }} -
              {{ r.endDate | customDate : "showHours" }}
            </p>
            <ng-container *ngFor="let v of r.veichles">
              <div class="px-2">{{ v.quantity }}x {{ v.veichle.name }}</div>
            </ng-container>
          </div>
        </ng-container>
      </div>
      <p-divider></p-divider>
      <div class="flex flex-column mt-1 gap-2">
        <p class="font-semibold mb-2">Attività</p>
        <ng-container formArrayName="activities">
          <ng-container *ngFor="let a of activities.controls; let i = index">
            <div
              class="p-4 border-1 surface-card surface-border border-round flex justify-content-between"
            >
              <div class="flex flex-column gap-2 flex-1">
                <p>{{ a.get("name")?.value }}</p>
                <p>{{ a.get("description")?.value }}</p>
                <div class="flex flex-column">
                  <div
                    class="flex flex-column gap-2 flex-1"
                    [formGroupName]="i"
                  >
                    <label class="font-semibold">Note su questa attività</label>
                    <textarea
                      rows="5"
                      cols="30"
                      pInputTextarea
                      formControlName="note"
                    ></textarea>
                    {{ activities.at(i).value | json }}
                  </div>
                </div>
              </div>
              <p>{{ a.get("price")?.value | currency : "EUR" : "symbol" }}</p>
            </div>
          </ng-container>
        </ng-container>
      </div>
    </div>
  </ng-container>
</div>
<div class="w-full flex justify-content-between mb-3">
  <p-button
    label="Indietro"
    (onClick)="onPrevStep()"
    icon="pi pi-angle-left"
    styleClass="p-button-secondary"
  ></p-button>
  <p-button
    label="Completa"
    (onClick)="onNextStep()"
    icon="pi pi-check"
    iconPos="right"
  ></p-button>
</div>
